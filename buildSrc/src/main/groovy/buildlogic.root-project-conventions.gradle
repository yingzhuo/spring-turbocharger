plugins {
	id 'base'
}

defaultTasks 'classes'

tasks.named('wrapper') {
	if (providers.gradleProperty('useChinaGradleWrapperDistributionMirror').getOrElse('true').equalsIgnoreCase('true')) {
		distributionUrl = gradleWrapperDistributionUrl
	}
	networkTimeout = 30000
	validateDistributionUrl = false
	distributionType = Wrapper.DistributionType.ALL
}

tasks.register('pushToVcs', Exec) {
	group = 'vcs'
	description = 'Commit and push codes to gitee/github.'

	workingDir(rootDir)
	commandLine('bash', "$rootDir/buildSrc/config/vcs/push.sh")
}

tasks.named('clean') {
	mustRunAfter(SharedFunctions.getLeafProjectNames(rootProject).collect { "${it}:clean" })

	doLast {
		delete fileTree(rootDir) {
			include '**/.DS_Store'
			include '**/*.log'
		}
	}
}
